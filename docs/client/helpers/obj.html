<!DOCTYPE html>

<html>
<head>
  <title>obj.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="dom.html">
                dom.js
              </a>
            
              
              <a class="source" href="fn.html">
                fn.js
              </a>
            
              
              <a class="source" href="is.html">
                is.js
              </a>
            
              
              <a class="source" href="obj.html">
                obj.js
              </a>
            
              
              <a class="source" href="Timer.html">
                Timer.js
              </a>
            
              
              <a class="source" href="onload.html">
                onload.js
              </a>
            
              
              <a class="source" href="poly.html">
                poly.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>obj.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Load dependencies</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> is = <span class="hljs-built_in">require</span>(<span class="hljs-string">'is'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Object declaration</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> obj = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
obj.indexOf = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(id, array)</span> {</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++) {
    <span class="hljs-keyword">if</span> (array[i].id == id) <span class="hljs-keyword">return</span> i;
  }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
obj.nextIdIn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(array)</span> {</span>
  <span class="hljs-keyword">return</span> array.length &gt; <span class="hljs-number">0</span> ? array[array.length-<span class="hljs-number">1</span>].id + <span class="hljs-number">1</span> : <span class="hljs-number">1</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> hasOwnProp = hasOwnProperty || <span class="hljs-built_in">Object</span>.prototype.hasOwnProperty;
<span class="hljs-keyword">var</span> toString = <span class="hljs-built_in">Object</span>.prototype.toString,
    hasDontEnumBug = !({toString: <span class="hljs-literal">null</span>}).propertyIsEnumerable(<span class="hljs-string">'toString'</span>),
    dontEnums = [
      <span class="hljs-string">'toString'</span>,
      <span class="hljs-string">'toLocaleString'</span>,
      <span class="hljs-string">'valueOf'</span>,
      <span class="hljs-string">'hasOwnProperty'</span>,
      <span class="hljs-string">'isPrototypeOf'</span>,
      <span class="hljs-string">'propertyIsEnumerable'</span>,
      <span class="hljs-string">'constructor'</span>
    ],
    dontEnumsLength = dontEnums.length;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
obj.keys = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> {</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'function'</span> || obj === <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Object.keys called on non-object'</span>);

  <span class="hljs-keyword">var</span> result = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prop <span class="hljs-keyword">in</span> obj) {
    <span class="hljs-keyword">if</span> (hasOwnProp.call(obj, prop)) result.push(prop);
  }

  <span class="hljs-keyword">if</span> (hasDontEnumBug) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i &lt; dontEnumsLength; i++) {
      <span class="hljs-keyword">if</span> (hasOwnProp.call(obj, dontEnums[i])) result.push(dontEnums[i]);
    }
  }
  <span class="hljs-keyword">return</span> result;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
obj.extend = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
  <span class="hljs-keyword">var</span> options, name, src, copy, copyIsArray, clone, target = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>] || {},
  i = <span class="hljs-number">1</span>,
  length = <span class="hljs-built_in">arguments</span>.length,
  deep = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> target === <span class="hljs-string">"boolean"</span>) {
    deep = target;
    target = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] || {};
    i = <span class="hljs-number">2</span>;
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> target !== <span class="hljs-string">"object"</span> &amp;&amp; !is.Function(target)) {
    target = {};
  }
  <span class="hljs-keyword">if</span> (length === i) {
    target = <span class="hljs-keyword">this</span>;
    --i;
  }
  <span class="hljs-keyword">for</span> (i; i &lt; length; i++) {
    <span class="hljs-keyword">if</span> ((options = <span class="hljs-built_in">arguments</span>[i]) !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">for</span> (name <span class="hljs-keyword">in</span> options) {
        src = target[name];
        copy = options[name];
        <span class="hljs-keyword">if</span> (target === copy) {
          <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">if</span> (deep &amp;&amp; copy &amp;&amp; (is.PlainObject(copy) || (copyIsArray = is.Array(copy)))) {
          <span class="hljs-keyword">if</span> (copyIsArray) {
            copyIsArray = <span class="hljs-literal">false</span>;
            clone = src &amp;&amp; is.Array(src) ? src : [];
          } <span class="hljs-keyword">else</span> {
            clone = src &amp;&amp; is.PlainObject(src) ? src : {};
          }
          target[name] = extend(deep, clone, copy);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (copy !== <span class="hljs-literal">undefined</span>) {
          target[name] = copy;
        }
      }
    }
  }
  <span class="hljs-keyword">return</span> target;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
obj.define = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(extend, initializer, methods)</span> {</span>
  <span class="hljs-keyword">var</span> func, prototype = <span class="hljs-built_in">Object</span>.create(extend &amp;&amp; extend.prototype);

  <span class="hljs-keyword">if</span> (methods) {
    obj.keys(methods).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span>{</span>
      prototype[key] = methods[key];
    });
  }

  func = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">var</span> that = <span class="hljs-built_in">Object</span>.create(prototype);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> initializer === <span class="hljs-string">'function'</span>) {
      initializer.apply(that, <span class="hljs-built_in">arguments</span>);
    }
    <span class="hljs-keyword">return</span> that;
  };

  obj.keys(extend).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key)</span>{</span>
    func[key] = extend[key];
  });

  func.prototype = prototype;
  prototype.constructor = func;
  <span class="hljs-keyword">return</span> func;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
obj.identifier = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(seed)</span>{</span>
  <span class="hljs-keyword">var</span> m, chunk, plus, _id, mod;
  <span class="hljs-keyword">var</span> digits = <span class="hljs-number">6</span>;

  m = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> d = <span class="hljs-number">0</span>; d &lt; digits; d++) {
    m *= <span class="hljs-number">16</span>;
  }

  <span class="hljs-keyword">if</span> (!seed &amp;&amp; seed !== <span class="hljs-number">0</span>) {
    seed = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random()*m);
  }

  seed = (seed &gt;= m) ? m-<span class="hljs-number">1</span> : (seed &lt; <span class="hljs-number">0</span>) ? <span class="hljs-built_in">Math</span>.abs(seed) : seed;</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>invert all even seeds.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (seed % <span class="hljs-number">2</span>) seed = m-seed;

  chunk = (seed % <span class="hljs-number">16</span>);
  chunk = <span class="hljs-built_in">Math</span>.abs( (chunk%<span class="hljs-number">2</span>?<span class="hljs-number">7</span>:<span class="hljs-number">0</span>) + <span class="hljs-built_in">Math</span>.floor(chunk/<span class="hljs-number">2</span>) );
  seed += m / <span class="hljs-number">16</span> * chunk;
  seed %= m;

  mod = m/<span class="hljs-number">16</span>/<span class="hljs-number">16</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
    seed += ((seed % <span class="hljs-number">16</span>)+i)*mod;
    p = <span class="hljs-number">4</span> - i;
    seed += ((seed % <span class="hljs-number">256</span>)+(p*<span class="hljs-number">5</span>))*mod;
    p %= <span class="hljs-number">2</span>;
    seed += ((seed % <span class="hljs-number">16</span>)+(p*<span class="hljs-number">7</span>))*mod;
    mod /= <span class="hljs-number">16</span>;
  }

  seed %= m;

  _id = seed.toString(<span class="hljs-number">16</span>);
  <span class="hljs-keyword">while</span>(_id.length &lt; <span class="hljs-number">6</span>){
    _id = <span class="hljs-string">'0'</span>+_id;
  }

  <span class="hljs-keyword">return</span> _id;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Expose to other internal modules</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
module.exports = obj;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
