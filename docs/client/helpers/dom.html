<!DOCTYPE html>

<html>
<head>
  <title>dom.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="dom.html">
                dom.js
              </a>
            
              
              <a class="source" href="fn.html">
                fn.js
              </a>
            
              
              <a class="source" href="is.html">
                is.js
              </a>
            
              
              <a class="source" href="obj.html">
                obj.js
              </a>
            
              
              <a class="source" href="Timer.html">
                Timer.js
              </a>
            
              
              <a class="source" href="onload.html">
                onload.js
              </a>
            
              
              <a class="source" href="poly.html">
                poly.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>dom.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Load dependencies</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> is = <span class="hljs-built_in">require</span>(<span class="hljs-string">'is'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Declare object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> DOM = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> html5elements = [<span class="hljs-string">'html'</span>, <span class="hljs-string">'body'</span>, <span class="hljs-string">'script'</span>, <span class="hljs-string">'div'</span>, <span class="hljs-string">'span'</span>, <span class="hljs-string">'object'</span>,
  <span class="hljs-string">'h1'</span>, <span class="hljs-string">'h2'</span>, <span class="hljs-string">'h3'</span>, <span class="hljs-string">'h4'</span>, <span class="hljs-string">'h5'</span>, <span class="hljs-string">'h6'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'blockquote'</span>, <span class="hljs-string">'pre'</span>, <span class="hljs-string">'abbr'</span>,
  <span class="hljs-string">'address'</span>, <span class="hljs-string">'cite'</span>, <span class="hljs-string">'code'</span>, <span class="hljs-string">'del'</span>, <span class="hljs-string">'dfn'</span>, <span class="hljs-string">'em'</span>, <span class="hljs-string">'img'</span>, <span class="hljs-string">'ins'</span>, <span class="hljs-string">'kbd'</span>,
  <span class="hljs-string">'q'</span>, <span class="hljs-string">'samp'</span>, <span class="hljs-string">'small'</span>, <span class="hljs-string">'strong'</span>, <span class="hljs-string">'sub'</span>, <span class="hljs-string">'sup'</span>, <span class="hljs-string">'var'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'i'</span>, <span class="hljs-string">'dl'</span>,
  <span class="hljs-string">'dt'</span>, <span class="hljs-string">'dd'</span>, <span class="hljs-string">'ol'</span>, <span class="hljs-string">'ul'</span>, <span class="hljs-string">'li'</span>, <span class="hljs-string">'fieldset'</span>, <span class="hljs-string">'form'</span>, <span class="hljs-string">'label'</span>, <span class="hljs-string">'legend'</span>,
  <span class="hljs-string">'table'</span>, <span class="hljs-string">'caption'</span>, <span class="hljs-string">'tbody'</span>, <span class="hljs-string">'tfoot'</span>, <span class="hljs-string">'thead'</span>, <span class="hljs-string">'tr'</span>, <span class="hljs-string">'th'</span>, <span class="hljs-string">'td'</span>,
  <span class="hljs-string">'article'</span>, <span class="hljs-string">'aside'</span>, <span class="hljs-string">'canvas'</span>, <span class="hljs-string">'details'</span>, <span class="hljs-string">'figcaption'</span>, <span class="hljs-string">'figure'</span>,
  <span class="hljs-string">'footer'</span>, <span class="hljs-string">'header'</span>, <span class="hljs-string">'hgroup'</span>, <span class="hljs-string">'menu'</span>, <span class="hljs-string">'nav'</span>, <span class="hljs-string">'section'</span>, <span class="hljs-string">'summary'</span>,
  <span class="hljs-string">'iframe'</span>, <span class="hljs-string">'time'</span>, <span class="hljs-string">'mark'</span>, <span class="hljs-string">'audio'</span>, <span class="hljs-string">'video'</span>, <span class="hljs-string">'link'</span>, <span class="hljs-string">'input'</span>];

<span class="hljs-keyword">var</span> isLegalElement = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(tag)</span> {</span>
  <span class="hljs-keyword">return</span> is.inArray(tag, html5elements);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> audioSupport = {
  mp3: <span class="hljs-literal">false</span>,
  ogg: <span class="hljs-literal">false</span>
};

(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
  <span class="hljs-keyword">var</span> audio = document.createElement(<span class="hljs-string">'audio'</span>);
  <span class="hljs-keyword">if</span> (audio.canPlayType) {
    audioSupport.mp3 = <span class="hljs-string">""</span> !== audio.canPlayType(<span class="hljs-string">'audio/mpeg'</span>);
    audioSupport.ogg = <span class="hljs-string">""</span> !== audio.canPlayType(<span class="hljs-string">'audio/ogg; codecs="vorbis"'</span>);
  }
})();</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> extractTag = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(tag)</span> {</span>
  <span class="hljs-keyword">var</span> match = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-regexp">/^([a-zA-Z]*)([#.\-a-zA-Z]*)/</span>).exec(tag);
  <span class="hljs-keyword">return</span> {
    name: match[<span class="hljs-number">1</span>],
    selectors: match[<span class="hljs-number">2</span>]
  };
};</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> buildAttributes = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attrs, selectors, multipleElements)</span> {</span>
  attrs = attrs || {};
  <span class="hljs-keyword">var</span> id, classes = [];

  <span class="hljs-keyword">while</span>((selectors = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-regexp">/^([#|.][\-a-zA-Z]+)/</span>).exec(selectors)) !== <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">var</span> match = selectors[<span class="hljs-number">0</span>];
    selectors = selectors.input.replace(match, <span class="hljs-string">''</span>);

    <span class="hljs-keyword">if</span> (match.charAt(<span class="hljs-number">0</span>) == <span class="hljs-string">"#"</span>) {
      <span class="hljs-keyword">if</span> (multipleElements) {
        console.log(<span class="hljs-string">'An id should be unique to one element!'</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!id) {
        id = match.substring(<span class="hljs-number">1</span>);
      } <span class="hljs-keyword">else</span> {
        console.log(<span class="hljs-string">'An element should only have a maximum of one id!'</span>);
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (match.charAt(<span class="hljs-number">0</span>) == <span class="hljs-string">"."</span>) {
      classes.push(match.substring(<span class="hljs-number">1</span>));
    }
  }

  <span class="hljs-keyword">return</span> {
    id: id,
    classes: classes
  };
};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.splice = <span class="hljs-built_in">Array</span>.prototype.splice;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Currently only looks for very basic string</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.make = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector, attrs, callback)</span> {</span>
  <span class="hljs-keyword">var</span> tag = extractTag(selector);
  attrs = attrs || {};

  <span class="hljs-keyword">if</span>(!isLegalElement(tag.name)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Illegal tag name "'</span>+tag.name+<span class="hljs-string">'" passed to topdown.DOM.make'</span>);
  }

  <span class="hljs-keyword">var</span> elements = (is.Array(attrs)) ? attrs : [attrs];
  <span class="hljs-keyword">var</span> multipleElements = elements.length &gt; <span class="hljs-number">1</span>;
  callback = callback || <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>};
  attrs = buildAttributes(attrs, tag.selectors, multipleElements);
  <span class="hljs-keyword">var</span> id = attrs.id;
  <span class="hljs-keyword">var</span> classes = attrs.classes;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span><span class="hljs-params">(array, callback)</span> {</span>
    <span class="hljs-keyword">var</span> properties = array[<span class="hljs-number">0</span>],
        e = document.createElement(tag.name),
        appendto;

    <span class="hljs-keyword">if</span> (properties.appendto){
      appendto = properties.appendto;
      <span class="hljs-keyword">delete</span> properties.appendto;
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> att <span class="hljs-keyword">in</span> properties) {
      <span class="hljs-keyword">if</span> (properties.hasOwnProperty(att)) {
        e.setAttribute(att, properties[att]);
      }
    }

    e.onload = e.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
      array.shift();
      <span class="hljs-keyword">if</span>(array.length) {
        append(array, callback);
      } <span class="hljs-keyword">else</span> {
        callback();
      }
    };

    <span class="hljs-keyword">if</span> (id) e.id = id;
    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>, file; ($<span class="hljs-keyword">class</span> = classes[n]); n++ ) {
      e.classList.add($<span class="hljs-keyword">class</span>);
    }

    appendto = appendto || <span class="hljs-string">'body'</span>;
    <span class="hljs-keyword">return</span> DOM.get(appendto)[<span class="hljs-number">0</span>].appendChild(e);
  }

  <span class="hljs-keyword">return</span> append(elements, callback);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>A basic version of this for my own purposes:
<a href="http://james.padolsey.com/jquery/#v=1.7.2&amp;fn=jQuery.fn.init">http://james.padolsey.com/jquery/#v=1.7.2&amp;fn=jQuery.fn.init</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.get = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector)</span> {</span>
  <span class="hljs-keyword">var</span> target;
  <span class="hljs-keyword">var</span> selected = [];
  <span class="hljs-keyword">if</span> (selector) {
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span>(selector) === <span class="hljs-string">"string"</span>) {
      <span class="hljs-keyword">if</span>(selector.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">"#"</span>) {
        target = selector.slice(<span class="hljs-number">1</span>);
        <span class="hljs-keyword">var</span> id = document.getElementById(target);
        selected = id ? [id] : [];
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(selector.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">"."</span>) {
        target = selector.slice(<span class="hljs-number">1</span>);
        selected = document.getElementsByClassName(target);
      } <span class="hljs-keyword">else</span> {
        selected = document.getElementsByTagName(selector);
      }
    }
  }

  <span class="hljs-keyword">this</span>.splice(<span class="hljs-number">0</span>);
  <span class="hljs-built_in">Array</span>.prototype.push.apply( <span class="hljs-keyword">this</span>, selected );
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.each = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(func)</span>{</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.length; i++) {
    func(<span class="hljs-keyword">this</span>[i]);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.on = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(action, func)</span>{</span>
  DOM.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    e.addEventListener(action, func);
  });
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.hide = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
  DOM.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    e.style.display = <span class="hljs-string">'none'</span>;
  });
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.show = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
  DOM.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    e.style.display = <span class="hljs-string">''</span>;
  });
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.first = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
  <span class="hljs-keyword">this</span>.splice(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.html = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value)</span> {</span>
  DOM.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    e.innerHTML = value;
  });
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.attr = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attr, value)</span> {</span>
  DOM.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    e.setAttribute(attr, <span class="hljs-string">""</span>+value);
  });
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.removeAttr = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attr)</span> {</span>
  DOM.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    e.removeAttribute(attr);
  });
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
DOM.css = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(property, value)</span>{</span>
  DOM.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span>{</span>
    <span class="hljs-keyword">var</span> styles = e.getAttribute(<span class="hljs-string">'style'</span>) || <span class="hljs-string">''</span>;
    value += is.Numeric(value) ? <span class="hljs-string">'px'</span> : <span class="hljs-string">''</span>;
    e.setAttribute(<span class="hljs-string">'style'</span>, styles + <span class="hljs-string">' '</span> + property + <span class="hljs-string">': '</span> + value + <span class="hljs-string">';'</span>);
  });
};</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Expose to other internal modules</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
module.exports = DOM;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
